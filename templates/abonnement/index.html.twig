{% extends 'base.html.twig' %}

{% block title %}Abonnement index{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <style>
        .toHide {
            display: block;
        }

        .toPrint {
            display: none;
        }

        .seconde-page {
            -webkit-print-color-adjust: exact;
            display: block;
        }

        .cote-gauche .ligne span {
            -webkit-print-color-adjust: exact;
            color: #f0ad4e;
        }
    </style>
    <link rel="stylesheet" media="print" href="{{ asset('print/css/print.css') }}">
    <link rel="stylesheet" href="{{ asset('payment/css/app.css') }}">
{% endblock %}
{% block javascripts %}
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script type="text/javascript">
        function survol(filename, expiration) {
            // alert(expiration)
            let file = filename;
            let image = document.getElementById('photop');
            image.src = ("{{ asset('clients/images/') }}" + file);
        }

        function retablir(id) {
            swal({
                title: "Etes vous sûr ?",
                text: "Cliquez sur ok pour un réabonnement ou cancel pour annuler!",
                icon: "warning",
                buttons: true,
                // dangerMode: true,
            })
                .then((willDelete) => {
                    if (willDelete) {
                        window.location.href = "http://localhost:8000/abonnement/retablir/" + id;
                        // swal("Poof! Your imaginary file has been deleted!", {
                        //     icon: "success",
                        // });
                    }
                    // } else {
                    //     swal("Your imaginary file is safe!");
                    // }
                });

        }

        function printContent(id, nom, prenom, type, section, filename, expiration) {
            // alert(expiration.toString());
            //LA PARTIE AFFICHAGE DES INFORMATIONS DE L'ABONNE SUR LA CARTE
            window.location.href = "http://localhost:8000/abonnement/valider/" + id;
            let image = document.getElementById('photop');
            let idp = id;
            let nomp = nom;
            let prenomp = prenom;
            let typep = type;
            let sectionp = section;
            let file = filename;
            let exp = expiration;
            image.src = ("{{ asset('clients/images/') }}" + file);
            let str = "" + idp;
            let pad = "00000";
            let ans = pad.substring(0, pad.length - str.length) + str;
            document.querySelector('#numerop').innerHTML = ans;

            document.getElementById('nomp').innerHTML = nomp;
            document.getElementById('prenomp').innerHTML = prenomp;
            document.getElementById('typep').innerHTML = typep;
            document.getElementById('sectionp').innerHTML = sectionp;
            document.getElementById('datep').innerHTML = exp;

            image.src = ("{{ asset('clients/images/') }}" + file);

            //LA PARTIE HIDE AND SHOW
            var hide = document.querySelector('.toHide');
            var show = document.querySelector('.toPrint');
            hide.style.display = 'none';
            show.style.display = 'block';
            window.print();
            show.style.display = 'none';
            hide.style.display = 'block';

            //LA CARTE EST DEJA IMPRIMEE

            return false;
        }
    </script>
{% endblock %}

{% block body %}
 <div class="box box-default">
          <div class="box-header with-border">
          <div class="col-md-6">
            <h4><i class="fa fa-list"></i>&nbsp;<big>Liste des Abonnés</big></h4>
          </div>
            <div class="col-md-6 text-right">
                <a class="btn btn-info" href="{{ path('abonnement_new') }}"><i class="glyphicon glyphicon-plus"></i>&nbsp;Nouveau Abonné</a>
            </div>
          </div>
          <!-- /.box-body -->
        </div>

<div class="row">
    <div class="col-xs-12">
        <div class="box box-primary">
            <div class="box-header">
                <h1 class="box-title">Liste des Abonnés</h1>
            </div>
            <div class="box-body">
    <table class="table">
        <thead>
            <tr>
                <th>Nom</th>
                <th>Prenom</th>
                <th>Adresse</th>
                <th>Telephone</th>
                <th>Type d'abonnement</th>
                <th>Prix</th>
                <th>Date d'expiration</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for abonnement in abonnements %}
            <tr>
                <td>{{ abonnement.nom }}</td>
                <td>{{ abonnement.prenom }}</td>
                <td>{{ abonnement.adresse }}</td>
                <td>{{ abonnement.telephone }}</td>
                <td>{{ abonnement.type }}</td>
                <td>{{ abonnement.type.prix }}</td>
                <td>
                    <a class="btn btn-info" role="button" href="{{ path('abonnement_show', {'id': abonnement.id}) }}"><i class="glyphicon glyphicon-eye-open"></i>&nbsp;show</a>
                    <a class="btn btn-warning" role="button" href="{{ path('abonnement_edit', {'id': abonnement.id}) }}"><i class="glyphicon glyphicon-pencil"></i>&nbsp;edit</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="9">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
   </div>
        </div>
    </div>
</div>
{% endblock %}
